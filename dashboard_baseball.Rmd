---
title: "Dashboard-baseball"
output: flexdashboard::flex_dashboard
runtime: shiny
date: "2025-10-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(flexdashboard)
library(shiny)
library(DT)
library(dplyr)
library(ggplot2)
library(plotly)
stats <- read.csv("data/stats_joueurs.csv", header=TRUE)
stats <- stats %>%
  select(
    last_name..first_name,
    pa,
    k_percent,
    bb_percent,
    on_base_plus_slg,
    b_gnd_into_dp,
    b_hit_ground,
    b_hit_fly,
    b_out_fly,
    b_out_ground,
    b_out_line_drive,
    b_out_popup,
    b_swinging_strike,
    fast_swing_rate,
    sweet_spot_percent,
    barrel_batted_rate,
    hard_hit_percent,
    avg_best_speed,
    avg_hyper_speed,
    whiff_percent,
    swing_percent
  ) %>%
  rename(
    nom_joueur = last_name..first_name,
    presences_au_baton = pa,
    pourcent_retraits_baton = k_percent,
    pourcent_buts_sur_balles = bb_percent,
    OPS = on_base_plus_slg,
    double_jeu = b_gnd_into_dp,
    coups_sur_sol = b_hit_ground,
    coups_en_fleche = b_hit_fly,
    retraits_en_fleche = b_out_fly,
    retraits_au_sol = b_out_ground,
    retraits_ligne = b_out_line_drive,
    retraits_popup = b_out_popup,
    retraits_elan_manque = b_swinging_strike,
    taux_swings_rapides = fast_swing_rate,
    pourcent_sweet_spot = sweet_spot_percent,
    taux_frappe_puissante = barrel_batted_rate,
    pourcent_frappe_forte = hard_hit_percent,
    vitesse_moy_frappe = avg_best_speed,
    vitesse_moy_frappe_puissante = avg_hyper_speed,
    pourcent_elans_manques = whiff_percent,
    pourcent_elans_total = swing_percent
  )
```

# onglet1

## Résumé général


```{r, echo=FALSE, results='asis'}
library(htmltools)


# Légende
tags$div(
  style = "margin-bottom: 10px;",
  tags$span("⬤ ", style = "color:#2ECC71;"), "Top 10% (meilleures performances) ",
  tags$span("⬤ ", style = "color:#E74C3C; margin-left: 20px;"), "Bottom 10% (pires performances)"
)

# Tableau
datatable(
  stats,
  extensions = 'Buttons',
  options = list(
    dom = 'Bfrtip',
    buttons = c('copy', 'csv', 'excel'),
    pageLength = 15,
    lengthMenu = c(10, 15, 25, 50, 100),
    scrollX = TRUE,
    scrollY = '500px',
    autoWidth = TRUE,
    searchHighlight = TRUE
  ),
  filter = "top",
  rownames = FALSE,
  caption = "Statistiques des frappeurs MLB (Saison 2024–2025)"
) %>%
  formatStyle('OPS',
    backgroundColor = styleInterval(c(0.54, 0.83), c('#E74C3C', '', '#2ECC71'))
  ) %>%
  formatStyle('pourcent_frappe_forte',
    backgroundColor = styleInterval(c(29.36, 49.84), c('#E74C3C', '', '#2ECC71'))
  ) %>%
  formatStyle('taux_frappe_puissante',
    backgroundColor = styleInterval(c(2.40, 14.00), c('#E74C3C', '', '#2ECC71'))
  ) %>%
  formatStyle('pourcent_sweet_spot',
    backgroundColor = styleInterval(c(26.86, 39.00), c('#E74C3C', '', '#2ECC71'))
  ) %>%
  formatStyle('vitesse_moy_frappe',
    backgroundColor = styleInterval(c(96.77, 102.95), c('#E74C3C', '', '#2ECC71'))
  ) %>%
  formatStyle('vitesse_moy_frappe_puissante',
    backgroundColor = styleInterval(c(92.43, 96.03), c('#E74C3C', '', '#2ECC71'))
  ) %>%
  formatStyle('pourcent_elans_manques',
    backgroundColor = styleInterval(c(17.90, 34.48), c('#2ECC71', '', '#E74C3C'))
  )

```





# Onglet2
=======
# Onglet2 
>>>>>>> c2b25a412ac0d1b6a8d396ea037b89b655d0f2ff

## titre

```{r, echo=FALSE}
selectizeInput("Joueur", "Selectionne deux joueurs:", choices= sort(unique(stats$nom_joueur)), multiple=TRUE)


renderDataTable({
  datatable(
  subset(stats, last_name..first_name %in% input$Joueur),
  filter ="top",
  options = list(scrollX=TRUE, autoWidth = TRUE, dom='Brtip', buttons = c('colvis'), 
    columnDefs = list(list(visible = TRUE, targets = 0:6),list(visible = FALSE, targets = 7:22)) ),
  extensions = "Buttons"
  
  )})


renderPlotly({
  stats_graph <- subset(stats, last_name..first_name %in% input$Joueur)
  
  ggplotly(
    ggplot(stats_graph, aes(
      x= fast_swing_rate,
      y= hard_hit_percent,
      color= last_name..first_name)
            )
    +
    
      geom_line(linewidth=1) + geom_point(size=3) 
    +
      labs(title="", x="", y="",color = "Joueur")
    +
      theme_minimal()
      
  )
  
})





```

#Équipe


```{r}
#Ajout de l'équipe pour certains joueurs
library(readr)
library(dplyr)
library(tidyverse)
Dodgers <- read_csv("data/Dodgers.csv")
Red_Soxs <- read_csv("data/Red Soxs.csv")
Cubs <- read_csv("data/Cubs.csv")
Yankees <- read_csv("data/Yankees.csv")

stats <- stats %>%
  mutate(equipe = case_when(
    nom_joueur %in% Yankees ~ "Yankees",
    nom_joueur %in% Cubs ~ "Cubs",
    nom_joueur %in% Dodgers ~ "Dodgers",
    nom_joueur %in% Red_Soxs ~ "Red_Soxs",
    TRUE ~ NA_character_
  ))




```



